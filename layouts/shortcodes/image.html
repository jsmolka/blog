{{ $caption := .Get "caption" }}
{{ $src := add "/img/" (.Get "src") | safeURL }}
{{ $alt := .Get "alt" | default $caption }}
<figure>
  {{ printf "![%s](%s)" $alt $src | $.Page.RenderString }}
  {{ with $caption }}
    <figcaption>{{- . | $.Page.RenderString -}}</figcaption>
  {{ end }}
</figure>
