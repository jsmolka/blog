{{ $src := "" }}
{{ $alt := .Text | default .Title }}
{{ $img := .Page.Resources.GetMatch .Destination }}
{{ with $img }}
  {{ $src = .RelPermalink }}
{{ else }}
  {{ $src = .Destination | relURL }}
  {{ $img = imageConfig (path.Join "static" .Destination) }}
{{ end }}
<figure>
  <img src="{{ $src }}" alt="{{- $alt -}}" width="{{ $img.Width }}" height="{{ $img.Height }}" loading="lazy">
  {{ with .Title }}
    <figcaption>{{- . | $.Page.RenderString -}}</figcaption>
  {{ end }}
</figure>
